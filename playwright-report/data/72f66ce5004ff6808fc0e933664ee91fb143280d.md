# Test info

- Name: Asset Management >> Asset Upload >> should open upload modal when clicking upload button
- Location: /Users/thomasdowuona-hyde/AIRWAVE_0525_CODEX/tests/e2e/assets.test.ts:22:9

# Error details

```
Error: page.waitForSelector: Test timeout of 15000ms exceeded.
Call log:
  - waiting for locator('[data-testid="speed-dial-upload-files"]') to be visible
    30 × locator resolved to hidden <button tabindex="-1" type="button" role="menuitem" aria-label="Upload Files" data-testid="speed-dial-upload-files" data-mui-internal-clone-element="true" class="MuiButtonBase-root MuiFab-root MuiFab-circular MuiFab-sizeSmall MuiFab-default MuiFab-root MuiFab-circular MuiFab-sizeSmall MuiFab-default MuiSpeedDialAction-fab MuiSpeedDialAction-fabClosed css-red8cm-MuiButtonBase-root-MuiFab-root-MuiSpeedDialAction-fab">…</button>

    at /Users/thomasdowuona-hyde/AIRWAVE_0525_CODEX/tests/e2e/assets.test.ts:35:31
```

# Page snapshot

```yaml
- banner:
  - text: AIrWAVE Dashboard
  - button "Demo Agency"
  - button "T"
- navigation "navigation menu":
  - text: AIrWAVE
  - separator
  - list:
    - listitem:
      - button "Dashboard"
    - listitem:
      - button "Clients"
    - listitem:
      - button "Campaigns"
    - separator
    - listitem:
      - button "Assets"
    - listitem:
      - button "Matrix"
    - listitem:
      - button "Templates"
    - listitem:
      - button "Strategic Content"
    - separator
    - listitem:
      - button "Generate"
    - listitem:
      - button "Execute"
    - listitem:
      - button "Preview"
    - listitem:
      - button "Sign Off"
- main:
  - heading "Asset Library" [level=4]
  - tablist:
    - tab "All Assets" [selected]
    - tab "Images"
    - tab "Videos"
    - tab "Audio"
  - heading "IMAGE" [level=6]
  - heading "Sample Image 1" [level=6]
  - paragraph: image
  - heading "IMAGE" [level=6]
  - heading "Sample Image 2" [level=6]
  - paragraph: image
  - heading "VIDEO" [level=6]
  - heading "Sample Video 1" [level=6]
  - paragraph: video
  - button "Add asset"
  - menu:
    - menuitem "Upload Files"
    - menuitem "AI Generate"
- button "Open Tanstack query devtools":
  - img
- alert
- button "Open Next.js Dev Tools":
  - img
```

# Test source

```ts
   1 | import { test, expect } from './fixtures/test-fixtures';
   2 | import path from 'path';
   3 |
   4 | test.describe('Asset Management', () => {
   5 |   test.describe('Asset Upload', () => {
   6 |     test('should display assets page for authenticated users', async ({ authenticatedPage }) => {
   7 |       await authenticatedPage.goto('/assets');
   8 |       await authenticatedPage.waitForLoadState('networkidle');
   9 |       
   10 |       // Should show the assets page
   11 |       await expect(authenticatedPage.locator('h4')).toContainText('Asset Library');
   12 |       
   13 |       // Should show tabs
   14 |       await expect(authenticatedPage.locator('[role="tablist"]')).toBeVisible();
   15 |       
   16 |       // Should show speed dial for upload actions
   17 |       await expect(authenticatedPage.locator('[data-testid="speed-dial"]')).toBeVisible();
   18 |       
   19 |       await authenticatedPage.screenshot({ path: 'test-results/assets-page.png' });
   20 |     });
   21 |
   22 |     test('should open upload modal when clicking upload button', async ({ authenticatedPage }) => {
   23 |       await authenticatedPage.goto('/assets');
   24 |       await authenticatedPage.waitForLoadState('networkidle');
   25 |       
   26 |       // Use dispatchEvent to click the speed dial (bypasses interception)
   27 |       await authenticatedPage.evaluate(() => {
   28 |         const speedDial = document.querySelector('[data-testid="speed-dial"]');
   29 |         if (speedDial) {
   30 |           speedDial.dispatchEvent(new MouseEvent('click', { bubbles: true, cancelable: true }));
   31 |         }
   32 |       });
   33 |       
   34 |       // Wait for actions to appear
>  35 |       await authenticatedPage.waitForSelector('[data-testid="speed-dial-upload-files"]', { state: 'visible' });
      |                               ^ Error: page.waitForSelector: Test timeout of 15000ms exceeded.
   36 |       
   37 |       // Click upload files action
   38 |       await authenticatedPage.locator('[data-testid="speed-dial-upload-files"]').click();
   39 |       
   40 |       // Should open upload modal
   41 |       await expect(authenticatedPage.locator('[data-testid="upload-modal"]')).toBeVisible();
   42 |       
   43 |       // Should show dropzone
   44 |       await expect(authenticatedPage.locator('[data-testid="dropzone"]')).toBeVisible();
   45 |       
   46 |       await authenticatedPage.screenshot({ path: 'test-results/upload-modal.png' });
   47 |     });
   48 |
   49 |     test('should handle file selection and upload simulation', async ({ authenticatedPage }) => {
   50 |       await authenticatedPage.goto('/assets');
   51 |       await authenticatedPage.waitForLoadState('networkidle');
   52 |       
   53 |       // Open upload modal using dispatchEvent
   54 |       await authenticatedPage.evaluate(() => {
   55 |         const speedDial = document.querySelector('[data-testid="speed-dial"]');
   56 |         if (speedDial) {
   57 |           speedDial.dispatchEvent(new MouseEvent('click', { bubbles: true, cancelable: true }));
   58 |         }
   59 |       });
   60 |       await authenticatedPage.waitForSelector('[data-testid="speed-dial-upload-files"]', { state: 'visible' });
   61 |       await authenticatedPage.locator('[data-testid="speed-dial-upload-files"]').click();
   62 |       
   63 |       // Wait for modal to be visible
   64 |       await expect(authenticatedPage.locator('[data-testid="upload-modal"]')).toBeVisible();
   65 |       
   66 |       // Create a test file for upload
   67 |       const testFile = path.join(__dirname, 'fixtures', 'test-image.jpg');
   68 |       
   69 |       // Try to upload file via file input (simulate file selection)
   70 |       const fileInput = authenticatedPage.locator('input[type="file"]');
   71 |       if (await fileInput.count() > 0) {
   72 |         await fileInput.setInputFiles(testFile);
   73 |       } else {
   74 |         // If no file input, simulate dropzone interaction
   75 |         await authenticatedPage.evaluate(() => {
   76 |           const dropzone = document.querySelector('[data-testid="dropzone"]');
   77 |           if (dropzone) {
   78 |             // Create a mock file and dispatch drop event
   79 |             const file = new File(['test content'], 'test-image.jpg', { type: 'image/jpeg' });
   80 |             const dataTransfer = new DataTransfer();
   81 |             dataTransfer.items.add(file);
   82 |             
   83 |             const dropEvent = new DragEvent('drop', { dataTransfer });
   84 |             dropzone.dispatchEvent(dropEvent);
   85 |           }
   86 |         });
   87 |       }
   88 |       
   89 |       // Look for upload progress or success indicators
   90 |       const uploadButton = authenticatedPage.locator('[data-testid="upload-files-button"]');
   91 |       if (await uploadButton.count() > 0) {
   92 |         await uploadButton.click();
   93 |         
   94 |         // Wait for upload to complete (look for success state)
   95 |         await authenticatedPage.waitForTimeout(2000); // Allow time for upload simulation
   96 |       }
   97 |       
   98 |       await authenticatedPage.screenshot({ path: 'test-results/file-upload.png' });
   99 |     });
  100 |
  101 |     test('should close upload modal', async ({ authenticatedPage }) => {
  102 |       await authenticatedPage.goto('/assets');
  103 |       await authenticatedPage.waitForLoadState('networkidle');
  104 |       
  105 |       // Open upload modal using dispatchEvent
  106 |       await authenticatedPage.evaluate(() => {
  107 |         const speedDial = document.querySelector('[data-testid="speed-dial"]');
  108 |         if (speedDial) {
  109 |           speedDial.dispatchEvent(new MouseEvent('click', { bubbles: true, cancelable: true }));
  110 |         }
  111 |       });
  112 |       await authenticatedPage.waitForSelector('[data-testid="speed-dial-upload-files"]', { state: 'visible' });
  113 |       await authenticatedPage.locator('[data-testid="speed-dial-upload-files"]').click();
  114 |       
  115 |       // Modal should be visible
  116 |       await expect(authenticatedPage.locator('[data-testid="upload-modal"]')).toBeVisible();
  117 |       
  118 |       // Close modal using close button or escape key
  119 |       const closeButton = authenticatedPage.locator('[data-testid="close-upload-modal"]');
  120 |       if (await closeButton.count() > 0) {
  121 |         await closeButton.click();
  122 |       } else {
  123 |         // Try escape key
  124 |         await authenticatedPage.keyboard.press('Escape');
  125 |       }
  126 |       
  127 |       // Modal should be hidden
  128 |       await expect(authenticatedPage.locator('[data-testid="upload-modal"]')).not.toBeVisible();
  129 |     });
  130 |   });
  131 |
  132 |   test.describe('Asset Display & Management', () => {
  133 |     test('should show asset tabs and allow switching', async ({ authenticatedPage }) => {
  134 |       await authenticatedPage.goto('/assets');
  135 |       await authenticatedPage.waitForLoadState('networkidle');
```